<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini-Jeu</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            background-color: #222;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            overflow: hidden;
        }

        .game-container {
            width: 80%;
            height: 80%;
            position: relative;
            border: 2px solid white;
        }

        .car {
            position: absolute;
            bottom: 20px;
            left: 50%;
            width: 50px;
            height: 100px;
            background-color: red;
            transform: translateX(-50%);
        }

        .obstacle {
            position: absolute;
            top: -100px;
            width: 50px;
            height: 100px;
            background-color: blue;
            animation: fall 3s infinite;
        }

        @keyframes fall {
            0% { top: -100px; }
            100% { top: 100%; }
        }

        #score {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 24px;
        }

        #gameOver {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            color: red;
        }
    </style>
</head>
<body>

    <!-- Musique du jeu -->
    <audio id="gameMusic" loop>
        <source src="assets/music/phonk.mp3" type="audio/mp3">
        Votre navigateur ne prend pas en charge la balise audio.
    </audio>

    <div class="game-container">
        <div id="score">Score: 0</div>
        <div class="car" id="car"></div>
        <div id="gameOver">Game Over</div>
    </div>

    <script>
        // Jouer la musique dès que la page se charge
        window.onload = function() {
            var music = document.getElementById("gameMusic");
            music.play();  // Démarre la musique en boucle dès que la page se charge
        };

        const car = document.getElementById("car");
        const gameContainer = document.querySelector(".game-container");
        const scoreDisplay = document.getElementById("score");
        const gameOverDisplay = document.getElementById("gameOver");
        let score = 0;
        let gameOver = false;

        // Déplacer la voiture
        let carPosition = 50; // Position initiale de la voiture en pourcentage

        document.addEventListener("keydown", (event) => {
            if (event.key === "ArrowLeft" && carPosition > 10) {
                carPosition -= 10;
            } else if (event.key === "ArrowRight" && carPosition < 90) {
                carPosition += 10;
            }
            car.style.left = carPosition + "%";
        });

        // Créer un obstacle
        function createObstacle() {
            if (gameOver) return;
            const obstacle = document.createElement("div");
            obstacle.classList.add("obstacle");
            obstacle.style.left = Math.random() * 100 + "%"; // Position aléatoire de l'obstacle
            gameContainer.appendChild(obstacle);

            // Faire tomber l'obstacle
            const obstacleAnimation = obstacle.animate([
                { top: "-100px" },
                { top: "100%" }
            ], {
                duration: 3000, // 3 secondes par défaut
                iterations: 1
            });

            // Vérifier la collision
            obstacleAnimation.onfinish = function() {
                if (obstacle.getBoundingClientRect().top + obstacle.offsetHeight > car.getBoundingClientRect().top &&
                    obstacle.getBoundingClientRect().left < car.getBoundingClientRect().left + car.offsetWidth &&
                    obstacle.getBoundingClientRect().left + obstacle.offsetWidth > car.getBoundingClientRect().left) {
                    gameOver = true;
                    gameOverDisplay.style.display = "block";
                    music.pause();
                    music.currentTime = 0; // Réinitialise la musique
                } else {
                    score++;
                    scoreDisplay.textContent = "Score: " + score;
                    if (score % 5 === 0) {
                        // Augmenter la vitesse des obstacles
                        document.querySelectorAll(".obstacle").forEach(obstacle => {
                            obstacle.style.animationDuration = (parseFloat(obstacle.style.animationDuration) * 0.9) + "s"; // Réduire la durée d'animation
                        });
                    }
                }
                obstacle.remove(); // Retirer l'obstacle après qu'il soit tombé
            };

            // Créer un nouveau obstacle après un certain délai
            if (!gameOver) {
                setTimeout(createObstacle, 1000);
            }
        }

        // Démarrer le jeu
        createObstacle();

    </script>
</body>
</html>
