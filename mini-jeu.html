<script>
    const secretCode = ["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"];
    let userInput = [];

    // EmpÃªche le comportement par dÃ©faut (scroll ou rafraÃ®chissement)
    document.addEventListener("keydown", function(event) {
        const keysToBlock = ["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"];
        if (keysToBlock.includes(event.key)) {
            event.preventDefault();
        }

        userInput.push(event.key);
        if (userInput.length > secretCode.length) {
            userInput.shift();
        }

        if (JSON.stringify(userInput) === JSON.stringify(secretCode)) {
            startMiniGame();
        }
    });

    function startMiniGame() {
        // CrÃ©e dynamiquement la zone de jeu
        const gameContainer = document.createElement("div");
        gameContainer.innerHTML = `
            <style>
                #gameCanvas {
                    border: 2px solid black;
                    display: block;
                    margin: 30px auto;
                    background: #f0f0f0;
                }
                #gameOverText {
                    text-align: center;
                    font-size: 24px;
                    font-weight: bold;
                    display: none;
                    color: red;
                }
            </style>
            <canvas id="gameCanvas" width="600" height="400"></canvas>
            <div id="gameOverText">ðŸŽ‰ Merci d'avoir trouvÃ© l'easter egg !</div>
        `;
        document.body.appendChild(gameContainer);

        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        let player = { x: 50, y: 200, width: 40, height: 40, color: "#3498db" };
        let obstacle = { x: 600, y: Math.random() * 360, width: 30, height: 30, color: "#e74c3c" };
        let speed = 5;
        const keys = {};

        window.addEventListener("keydown", function(e) {
            keys[e.key] = true;
        });

        window.addEventListener("keyup", function(e) {
            keys[e.key] = false;
        });

        function update() {
            if (keys["ArrowUp"] && player.y > 0) player.y -= speed;
            if (keys["ArrowDown"] && player.y + player.height < canvas.height) player.y += speed;

            obstacle.x -= speed;
            if (obstacle.x < -obstacle.width) {
                obstacle.x = canvas.width;
                obstacle.y = Math.random() * (canvas.height - obstacle.height);
            }

            // Collision
            if (
                player.x < obstacle.x + obstacle.width &&
                player.x + player.width > obstacle.x &&
                player.y < obstacle.y + obstacle.height &&
                player.y + player.height > obstacle.y
            ) {
                endGame();
            }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Player
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.width, player.height);

            // Obstacle
            ctx.fillStyle = obstacle.color;
            ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
        }

        function gameLoop() {
            update();
            draw();
        }

        const gameInterval = setInterval(gameLoop, 20);

        function endGame() {
            clearInterval(gameInterval);
            document.getElementById("gameOverText").style.display = 'block';
        }
    }
</script>
